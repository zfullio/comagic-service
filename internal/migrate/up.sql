CREATE TABLE IF NOT EXISTS trackings.campaigns_comagic
(
    id                  INT64,
    status              STRING,
    name                STRING,
    dynamic_call_tracking STRUCT <
                                  reservation_time string,
                                  count_virtual_numbers int64,
                                  count_visits int64,
                                  coverage_visitors float64>,
    static_utm_source   STRING,
    static_utm_medium   STRING,
    static_utm_campaign STRING,
    static_utm_term     STRING,
    static_utm_content  STRING,
    static_utm_referrer STRING,
    static_utm_expid    STRING,
    date_update         TIMESTAMP
) PARTITION BY DATE (date_update);

create table smartis_test.calls_comagic
(
    date                              DATE,
    start_time                        DATETIME,
    finish_time                       DATETIME,
    virtual_phone_number              STRING,
    is_transfer                       BOOL,
    finish_reason                     STRING,
    direction                         STRING,
    source                            STRING,
    communication_number              INT64,
    communication_page_url            STRING,
    communication_id                  STRING,
    communication_type                STRING,
    is_lost                           BOOL,
    cpn_region_id                     STRING,
    cpn_region_name                   STRING,
    wait_duration                     INT64,
    total_wait_duration               INT64,
    lost_call_processing_duration     INT64,
    talk_duration                     INT64,
    clean_talk_duration               INT64,
    total_duration                    INT64,
    postprocess_duration              INT64,
    ua_client_id                      STRING,
    ym_client_id                      STRING,
    sale_date                         STRING,
    sale_cost                         FLOAT64,
    search_query                      STRING,
    search_engine                     STRING,
    referrer_domain                   STRING,
    referrer                          STRING,
    entrance_page                     STRING,
    gclid                             STRING,
    yclid                             STRING,
    ymclid                            STRING,
    ef_id                             STRING,
    channel                           STRING,
    site_id                           STRING,
    site_domain_name                  STRING,
    campaign_id                       STRING,
    campaign_name                     STRING,
    auto_call_campaign_name           STRING,
    visit_other_campaign              BOOL,
    visitor_id                        STRING,
    person_id                         STRING,
    visitor_type                      STRING,
    visitor_session_id                STRING,
    visits_count                      INT64,
    visitor_first_campaign_id         STRING,
    visitor_first_campaign_name       STRING,
    visitor_city                      STRING,
    visitor_region                    STRING,
    visitor_country                   STRING,
    visitor_device                    STRING,
    last_answered_employee_id         STRING,
    last_answered_employee_full_name  STRING,
    last_answered_employee_rating     INT64,
    first_answered_employee_id        INT64,
    first_answered_employee_full_name STRING,
    scenario_id                       STRING,
    scenario_name                     STRING,
    call_api_external_id              STRING,
    call_api_request_id               STRING,
    contact_phone_number              STRING,
    contact_full_name                 STRING,
    contact_id                        STRING,
    utm_source                        STRING,
    utm_medium                        STRING,
    utm_term                          STRING,
    utm_content                       STRING,
    utm_campaign                      STRING,
    openstat_ad                       STRING,
    openstat_campaign                 STRING,
    openstat_service                  STRING,
    openstat_source                   STRING,
    eq_utm_source                     STRING,
    eq_utm_medium                     STRING,
    eq_utm_term                       STRING,
    eq_utm_content                    STRING,
    eq_utm_campaign                   STRING,
    eq_utm_referrer                   STRING,
    eq_utm_expid                      STRING,
    attributes                        STRING,
    tags                              STRING,
    date_update                       TIMESTAMP
)
    options (
        friendly_name ='calls_comagic'
        );